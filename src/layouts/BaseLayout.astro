---
import Navigation from '../components/Navigation.astro';
import WRPFooter from '../components/WRPFooter.astro';
import Schema from '../components/Schema.astro';
import { SEO } from 'astro-seo';
import { ClientRouter } from 'astro:transitions';
import '../styles/global.css';

interface Props {
  title: string;
  description: string;
  showNav?: boolean;
  showFooter?: boolean;
  ogImage?: string;
  noindex?: boolean;
  includeSchema?: boolean;
}

const {
  title,
  description,
  showNav = true,
  showFooter = true,
  ogImage = '/og-image.jpg',
  noindex = false,
  includeSchema = true,
} = Astro.props;

const canonicalURL = new URL(Astro.url.pathname, Astro.site).toString();
const ogImageURL = new URL(ogImage, Astro.site).toString();
---

<!doctype html>
<html lang="en">
  <head>
    <SEO
      title={title}
      description={description}
      canonical={canonicalURL}
      noindex={noindex}
      openGraph={{
        basic: {
          title: title,
          type: 'website',
          image: ogImageURL,
          url: canonicalURL,
        },
        optional: {
          description: description,
          siteName: 'WRP Dubai',
          locale: 'en_AE',
        },
        image: {
          alt: title,
          width: 1200,
          height: 630,
          type: 'image/png',
        },
      }}
      twitter={{
        card: 'summary_large_image',
        site: '@wrp_ae',
        creator: '@wrp_ae',
        title: title,
        description: description,
        image: ogImageURL,
        imageAlt: title,
      }}
      extend={{
        link: [
          { rel: 'icon', type: 'image/svg+xml', href: '/favicon.svg' },
          { rel: 'icon', type: 'image/x-icon', href: '/favicon.ico' },
          { rel: 'icon', type: 'image/png', sizes: '96x96', href: '/favicon-96x96.png' },
          { rel: 'apple-touch-icon', sizes: '180x180', href: '/apple-touch-icon.png' },
          { rel: 'manifest', href: '/site.webmanifest' },
        ],
        meta: [
          { name: 'viewport', content: 'width=device-width' },
          { name: 'theme-color', content: '#000000' },
        ],
      }}
    />

    {includeSchema && <Schema />}

    <!-- View Transitions Fallback for browsers without native support -->
    <ClientRouter />

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700;900&family=Inter:wght@400;500;600;700&family=Montserrat:ital,wght@1,900&display=swap" rel="stylesheet" />

    <!-- Alpine.js -->
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>

    <!-- Microsoft Clarity -->
    <script type="text/javascript">
      (function(c,l,a,r,i,t,y){
        c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
        t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
        y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
      })(window, document, "clarity", "script", "u18n0h2k1x");
    </script>

    <style>
      [x-cloak] {
        display: none !important;
      }
    </style>
  </head>
  <body>
    {showNav && <Navigation />}

    <slot />

    {showFooter && <WRPFooter />}
  </body>
</html>
